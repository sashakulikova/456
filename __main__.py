import os
import logging
import time
import telebot
from telebot import types

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
BOT_TOKEN = os.getenv('BOT_TOKEN')
if not BOT_TOKEN:
    logger.error('–ù–µ –∑–∞–¥–∞–Ω BOT_TOKEN –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!')
    exit(1)

bot = telebot.TeleBot(BOT_TOKEN)

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
questions = {
    "–¥–æ—à–∫–æ–ª—å–Ω—ã–π –∏ –Ω–∞—á–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞": {
        "–ª—ë–≥–∫–∏–π": [
            {
                "question": "–ì–¥–µ –Ω–µ–ª—å–∑—è –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –Ω–∞—É—à–Ω–∏–∫–∞—Ö?",
                "options": ["–í –º–∞—à–∏–Ω–µ", "–í–±–ª–∏–∑–∏ –∂/–¥ –ø—É—Ç–µ–π", "–ù–∞ –ø—Ä–∏—Ä–æ–¥–µ", "–î–æ–º–∞"],
                "correct_answer": "–í–±–ª–∏–∑–∏ –∂/–¥ –ø—É—Ç–µ–π"
            },
            {
                "question": "–ß—Ç–æ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å –≤ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ?",
                "options": ["–°–ø–∞—Ç—å", "–ò–≥—Ä–∞—Ç—å –≤ –∫–∞—Ä—Ç—ã", "–í—ã—Å–æ–≤—ã–≤–∞—Ç—å—Å—è –∏–∑ –æ–∫–Ω–∞"],
                "correct_answer": "–í—ã—Å–æ–≤—ã–≤–∞—Ç—å—Å—è –∏–∑ –æ–∫–Ω–∞"
            },
            {
                "question": "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—ã –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å –Ω–∞ –≤–æ–∫–∑–∞–ª–µ?",
                "options": ["–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –ø—Ä–æ—Ö–æ–∂–µ–º—É –∑–∞ –ø–æ–º–æ—â—å—é", "–ñ–¥–∞—Ç—å, –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç –ø–æ–º–æ—â—å",
                            "–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ä–∞–±–æ—Ç–Ω–∏–∫—É –≤–æ–∫–∑–∞–ª–∞ –∏–ª–∏ –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–º—É", "–°–∞–º–æ–º—É –∏—Å–∫–∞—Ç—å —Ä–æ–¥–∏—Ç–µ–ª–µ–π"],
                "correct_answer": "–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Ä–∞–±–æ—Ç–Ω–∏–∫—É –≤–æ–∫–∑–∞–ª–∞ –∏–ª–∏ –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–º—É"
            }
        ],
        "—Å—Ä–µ–¥–Ω–∏–π": [
            {
                "question": "–ß—Ç–æ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –ù–ï–õ–¨–ó–Ø –¥–µ–ª–∞—Ç—å –Ω–∞ –∂/–¥ –ø—É—Ç—è—Ö –∏–ª–∏ –≤ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ?",
                "options": ["–ï—Å—Ç—å –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ –ø–æ–µ–∑–¥–∞", "–û—Ç–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ –≤ –≤–∞–≥–æ–Ω–µ",
                            "–°–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É –∏–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ç–µ–ª–µ—Ñ–æ–Ω –≤–±–ª–∏–∑–∏ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –ø—É—Ç–µ–π",
                            "–ñ–¥–∞—Ç—å –ø–æ–µ–∑–¥ –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π, –¥–µ—Ä–∂–∞—Å—å –±–ª–∏–∂–µ –∫ —Ü–µ–Ω—Ç—Ä—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"],
                "correct_answer": "–°–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É –∏–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ç–µ–ª–µ—Ñ–æ–Ω –≤–±–ª–∏–∑–∏ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –ø—É—Ç–µ–π"
            },
            {
                "question": "–í –∫–∞–∫–∏–µ –∏–≥—Ä—ã –º–æ–∂–Ω–æ –∏–≥—Ä–∞—Ç—å –≤–æ–∑–ª–µ –ø–æ–µ–∑–¥–æ–≤?",
                "options": ["–í–æ –≤—Å–µ, —ç—Ç–æ –∂–µ –≤–µ—Å–µ–ª–æ", "–í –ø–æ–¥–≤–∏–∂–Ω—ã–µ –∏–≥—Ä—ã(—Ñ—É—Ç–±–æ–ª, –ø—Ä—è—Ç–∫–∏, –¥–æ–≥–æ–Ω—è–ª–∫–∏)",
                            "–ù–µ –∏–≥—Ä–∞—Ç—å –≤ –∏–≥—Ä—ã –≤–æ–æ–±—â–µ", "–í –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã–µ –∏–≥—Ä—ã(—Å–ª–æ–≤–∞, –≥–æ—Ä–æ–¥–∞, –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏)"],
                "correct_answer": "–í –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã–µ –∏–≥—Ä—ã(—Å–ª–æ–≤–∞, –≥–æ—Ä–æ–¥–∞, –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏)"
            },
            {
                "question": "–ì–¥–µ –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–∞—Å—Å–∞–∂–∏—Ä, –ø–µ—Ä–µ–¥–≤–∏–≥–∞—è—Å—å –Ω–∞ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ?",
                "options": ["–í –≤–∞–≥–æ–Ω–µ", "–ù–∞ –ø–æ–¥–Ω–æ–∂–∫–∞—Ö –≤ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö –≤–∞–≥–æ–Ω–æ–≤", "–ù–∞ –∫—Ä—ã—à–µ –≤–∞–≥–æ–Ω–∞",
                            "–¶–µ–ø–ª—è—Ç—å—Å—è –∑–∞ –¥–≤–∏–∂—É—â–∏–π—Å—è –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π —Å–æ—Å—Ç–∞–≤, –º–∞–Ω–µ–≤—Ä–µ–Ω–Ω—ã–µ —Ç–µ–ø–ª–æ–≤–æ–∑—ã –∏ –¥—Ä—É–≥–∏–µ –ø–æ–¥–≤–∏–∂–Ω—ã–µ —Å–æ—Å—Ç–∞–≤—ã"],
                "correct_answer": "–í –≤–∞–≥–æ–Ω–µ"
            }
        ],
        "—Å–ª–æ–∂–Ω—ã–π": [
            {
                "question": "–ö–∞–∫–∞—è –∂–µ–ª–µ–∑–Ω–∞—è –¥–æ—Ä–æ–≥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π?",
                "options": ["–ú–æ—Å–∫–æ–≤—Å–∫–∞—è", "–¶–∞—Ä—Å–∫–æ—Å–µ–ª—å—Å–∫–∞—è", "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–∞—è", "–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∞—è"],
                "correct_answer": "–¶–∞—Ä—Å–∫–æ—Å–µ–ª—å—Å–∫–∞—è"
            }
        ]
    },
    "—Å—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞": {
        "–ª—ë–≥–∫–∏–π": [
            {
                "question": "–ö–∞–∫–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –ø—Ä–æ–≤–æ–¥–∞—Ö –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π —Å–µ—Ç–∏ –Ω–∞ –∂–µ–ª–µ–∑–Ω–æ–π –¥–æ—Ä–æ–≥–µ?",
                "options": ["10 —Ç—ã—Å—è—á –≤–æ–ª—å—Ç", "220 –≤–æ–ª—å—Ç", "600 –≤–æ–ª—å—Ç", "27 —Ç—ã—Å—è—á –≤–æ–ª—å—Ç"],
                "correct_answer": "27 —Ç—ã—Å—è—á –≤–æ–ª—å—Ç"
            },
            {
                "question": "–¢–≤–æ–∏ –¥—Ä—É–∑—å—è —Ä–µ—à–∏–ª–∏ —Ä–∞–∑–≤–ª–µ—á—å—Å—è, —Ä–∞–∑—Ä–∏—Å–æ–≤–∞—Ç—å –≤–∞–≥–æ–Ω—ã –ø–æ–µ–∑–¥–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç—å –∫–∞–º–Ω–∏ –Ω–∞ —Ä–µ–ª—å—Å—ã, —á—Ç–æ –±—É–¥–µ—à—å –¥–µ–ª–∞—Ç—å?",
                "options": ["–ü–æ–π–¥—É —Å –Ω–∏–º–∏ –∏ –ø–æ—Å—Ç–æ—é —Ä—è–¥–æ–º", "–°–¥–µ–ª–∞—é —Ç–æ–∂–µ, —á—Ç–æ –∏ –æ–Ω–∏, –º—ã –∂–µ –¥—Ä—É–∑—å—è",
                            "–°–¥–µ–ª–∞—é –≤–∏–¥, —á—Ç–æ –Ω–µ —Å–ª—ã—à–∞–ª –æ–± —ç—Ç–æ–º", "–°–¥–µ–ª–∞—é –∑–∞–º–µ—á–∞–Ω–∏–µ –∏ —Ä–∞—Å—Å–∫–∞–∂—É –≤–∑—Ä–æ—Å–ª—ã–º"],
                "correct_answer": "–°–¥–µ–ª–∞—é –∑–∞–º–µ—á–∞–Ω–∏–µ –∏ —Ä–∞—Å—Å–∫–∞–∂—É –≤–∑—Ä–æ—Å–ª—ã–º"
            },
            {
                "question": "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ç–æ—Ä–æ–ø–∏—à—å—Å—è –Ω–∞ –≤–∞–∂–Ω–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∂/–¥ –ø—É—Ç–∏?",
                "options": ["–ü–µ—Ä–µ–π–¥—É —Ç–∞–º, –≥–¥–µ —Å—á–∏—Ç–∞—é –±–µ–∑–æ–ø–∞—Å–Ω—ã–º", "–ü–æ—Å–º–æ—Ç—Ä—é, —á—Ç–æ –Ω–µ—Ç –ø–æ–µ–∑–¥–æ–≤ –∏ –ø–µ—Ä–µ–π–¥—É –ø–æ –ø—É—Ç—è–º",
                            "–ù–∞–π–¥—É –±–ª–∏–∂–∞–π—à–∏–π –ø–µ—à–µ—Ö–æ–¥–Ω—ã–π –Ω–∞—Å—Ç–∏–ª, –º–æ—Å—Ç –∏–ª–∏ –≤–∏–∞–¥—É–∫",
                            "–ü–æ–ø—Ä–æ—à—É –≤–∑—Ä–æ—Å–ª–æ–≥–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –º–µ–Ω—è —á–µ—Ä–µ–∑ –ø—É—Ç–∏"],
                "correct_answer": "–ü–æ–ø—Ä–æ—à—É –≤–∑—Ä–æ—Å–ª–æ–≥–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –º–µ–Ω—è —á–µ—Ä–µ–∑ –ø—É—Ç–∏"
            }
        ],
        "—Å—Ä–µ–¥–Ω–∏–π": [
            {
                "question": "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—ã –æ–∫–∞–∑–∞–ª–∏—Å—å –º–µ–∂–¥—É –¥–≤—É—Ö –¥–≤–∏–∂—É—â–∏—Ö—Å—è –ø–æ–µ–∑–¥–æ–≤?",
                "options": ["–í—Å—Ç–∞—Ç—å —Ä–æ–≤–Ω–æ, —Å–ø–∏–Ω–æ–π –∫ –æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–∞–≤—É –∏ –ª–∏—Ü–æ–º –∫ –¥—Ä—É–≥–æ–º—É, –∂–¥–∞—Ç—å, –∫–æ–≥–¥–∞ –æ–Ω–∏ –ø—Ä–æ–µ–¥—É—Ç",
                            "–ë–µ–∂–∞—Ç—å –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –±–æ–ª—å—à–µ–≥–æ –ø–æ–µ–∑–¥–∞", "–õ–µ—á—å –Ω–∞ –∑–µ–º–ª—é –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç –ø–æ–µ–∑–¥–æ–≤",
                            "–ó–≤–∞—Ç—å –Ω–∞ –ø–æ–º–æ—â—å"],
                "correct_answer": "–õ–µ—á—å –Ω–∞ –∑–µ–º–ª—é –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç –ø–æ–µ–∑–¥–æ–≤"
            },
            {
                "question": "–î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω —Å—Ç–æ–ø-–∫—Ä–∞–Ω?",
                "options": ["–î–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–µ–∑–¥–∞", "–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–µ–∑–¥–æ–º",
                            "–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–µ–∑–¥ –Ω–∞ –Ω—É–∂–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ",
                            "–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞"],
                "correct_answer": "–î–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–µ–∑–¥–∞"
            },
            {
                "question": "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—ã —É–≤–∏–¥–µ–ª–∏ –æ–≥–æ–ª—ë–Ω–Ω—ã–π –ø—Ä–æ–≤–æ–¥?",
                "options": ["–ü–æ–¥–æ–π—Ç–∏, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏ —Å–æ–æ–±—â–∏—Ç—å –≤–∑—Ä–æ—Å–ª—ã–º", "–ü–æ—Ç—Ä–æ–≥–∞—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ",
                            "–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –±–ª–∏–∂–µ, —á–µ–º –Ω–∞ 8 –º–µ—Ç—Ä–æ–≤ –∏ —Å–æ–æ–±—â–∏—Ç—å –≤–∑—Ä–æ—Å–ª—ã–º", "–û—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ —Ç–∞–∫"],
                "correct_answer": "–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –±–ª–∏–∂–µ, —á–µ–º –Ω–∞ 8 –º–µ—Ç—Ä–æ–≤ –∏ —Å–æ–æ–±—â–∏—Ç—å –≤–∑—Ä–æ—Å–ª—ã–º"
            }
        ],
        "—Å–ª–æ–∂–Ω—ã–π": [
            {
                "question": "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –≤—ã –ø—Ä–∏–µ—Ö–∞–ª–∏ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏–π –æ—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –ø—É–Ω–∫—Ç, –≥–¥–µ –Ω–µ—Ç –ø–µ—à–µ—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞—Å—Ç–∏–ª–∞, –≤–∏–∞–¥—É–∫–∞ –∏ –ø–æ–¥–∑–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞. –í–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–µ—á—å –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø—É—Ç–∏. –ö–∞–∫ –≤—ã –±—É–¥–µ—Ç–µ —ç—Ç–æ –¥–µ–ª–∞—Ç—å?",
                "options": [
                    "–ü—Ä–æ–π–¥—É –ø–æ –Ω–∞—Å—ã–ø–∏ –≤–¥–æ–ª—å –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –ø—É—Ç–µ–π –¥–æ —É–¥–æ–±–Ω–æ–≥–æ –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥ –º–µ—Å—Ç–∞ –∏ —Ç–∞–º –ø–µ—Ä–µ—Å–µ–∫—É –∂–µ–ª–µ–∑–Ω—É—é –¥–æ—Ä–æ–≥—É",
                    "–ü–µ—Ä–µ—Å–µ–∫—É –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –ø–æ–¥ –ø—Ä—è–º—ã–º —É–≥–ª–æ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—é—Å—å –¥–∞–ª—å—à–µ", "–í—ã–∫–æ–ø–∞—é –ø–æ–¥–∑–µ–º–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥",
                    "–ù–µ –±—É–¥—É –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø—É—Ç–∏"],
                "correct_answer": "–ü–µ—Ä–µ—Å–µ–∫—É –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –ø–æ–¥ –ø—Ä—è–º—ã–º —É–≥–ª–æ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—é—Å—å –¥–∞–ª—å—à–µ"
            }
        ]
    }
}

user_states = {}


def create_keyboard(options):
    """–°–æ–∑–¥–∞–µ—Ç Reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏"""
    keyboard = types.ReplyKeyboardMarkup(
        resize_keyboard=True,
        one_time_keyboard=True
    )
    for option in options:
        keyboard.add(option)
    return keyboard


@bot.message_handler(commands=['start', 'help'])
def handle_start(message):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥ /start –∏ /help"""
    try:
        user_id = message.chat.id
        user_states[user_id] = {}
        markup = create_keyboard(["–¥–æ—à–∫–æ–ª—å–Ω—ã–π –∏ –Ω–∞—á–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞", "—Å—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞"])
        bot.send_message(user_id, "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", reply_markup=markup)
        bot.register_next_step_handler(message, process_age)
        logger.info(f"–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –Ω–∞—á–∞–ª –æ–ø—Ä–æ—Å")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ handle_start: {e}")
        bot.reply_to(message, "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∫–æ–º–∞–Ω–¥–æ–π /start")


def process_age(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
    try:
        user_id = message.chat.id
        age = message.text

        if age not in questions:
            bot.send_message(user_id, "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö:")
            return handle_start(message)

        user_states[user_id]['age'] = age
        markup = create_keyboard(["–ª—ë–≥–∫–∏–π", "—Å—Ä–µ–¥–Ω–∏–π", "—Å–ª–æ–∂–Ω—ã–π"])
        bot.send_message(user_id, "–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:", reply_markup=markup)
        bot.register_next_step_handler(message, process_level)
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –≤—ã–±—Ä–∞–ª –≤–æ–∑—Ä–∞—Å—Ç: {age}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ process_age: {e}")
        bot.reply_to(message, "‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ /start")


def process_level(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏"""
    try:
        user_id = message.chat.id
        level = message.text

        if level not in ["–ª—ë–≥–∫–∏–π", "—Å—Ä–µ–¥–Ω–∏–π", "—Å–ª–æ–∂–Ω—ã–π"]:
            bot.send_message(user_id, "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö:")
            return process_age(message)

        user_states[user_id]['level'] = level
        user_states[user_id]['question_index'] = 0
        ask_question(message)
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –≤—ã–±—Ä–∞–ª —É—Ä–æ–≤–µ–Ω—å: {level}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ process_level: {e}")
        bot.reply_to(message, "‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ /start")


def ask_question(message):
    """–ó–∞–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
    try:
        user_id = message.chat.id
        age = user_states[user_id]['age']
        level = user_states[user_id]['level']
        question_index = user_states[user_id]['question_index']

        if question_index < len(questions[age][level]):
            question_data = questions[age][level][question_index]
            question_text = question_data["question"]
            options = question_data["options"]

            markup = create_keyboard(options)
            bot.send_message(user_id, question_text, reply_markup=markup)
            bot.register_next_step_handler(message, process_answer)
            logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user_id} –∑–∞–¥–∞–Ω –≤–æ–ø—Ä–æ—Å {question_index + 1}/{len(questions[age][level])}")
        else:
            bot.send_message(
                user_id,
                "üéâ –í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã —ç—Ç–æ–≥–æ —É—Ä–æ–≤–Ω—è!",
                reply_markup=types.ReplyKeyboardRemove()
            )
            logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –∑–∞–≤–µ—Ä—à–∏–ª –æ–ø—Ä–æ—Å —É—Ä–æ–≤–Ω—è {level}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ ask_question: {e}")
        bot.reply_to(message, "‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ /start")


def process_answer(message):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    try:
        user_id = message.chat.id
        user_answer = message.text
        age = user_states[user_id]['age']
        level = user_states[user_id]['level']
        question_index = user_states[user_id]['question_index']

        question_data = questions[age][level][question_index]
        correct_answer = question_data["correct_answer"]

        if user_answer == correct_answer:
            reply_text = "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! " + correct_answer
        else:
            reply_text = f"‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {correct_answer}"

        bot.send_message(
            user_id,
            reply_text,
            reply_markup=types.ReplyKeyboardRemove()
        )

        user_states[user_id]['question_index'] += 1
        time.sleep(1)  # –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –≤–æ–ø—Ä–æ—Å–æ–º
        ask_question(message)
        logger.info(
            f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–æ–ø—Ä–æ—Å {question_index + 1}: {'–≤–µ—Ä–Ω–æ' if user_answer == correct_answer else '–Ω–µ–≤–µ—Ä–Ω–æ'}")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ process_answer: {e}")
        bot.reply_to(message, "‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ /start")


def run_bot():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º"""
    logger.info("–ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞...")
    while True:
        try:
            bot.infinity_polling()
        except telebot.apihelper.ApiTelegramException as e:
            if "Conflict" in str(e):
                logger.error("–û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç: –¥—Ä—É–≥–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω")
            else:
                logger.error(f"–û—à–∏–±–∫–∞ API Telegram: {e}")
            time.sleep(10)
        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}\n–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...")
            time.sleep(5)
        finally:
            logger.info("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞...")


if __name__ == '__main__':
    try:
        logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞...")
        run_bot()
    except KeyboardInterrupt:
        logger.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        logger.critical(f"–§–∞—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")